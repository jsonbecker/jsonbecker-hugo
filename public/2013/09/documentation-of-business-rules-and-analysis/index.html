<html>
<head>
  <link href = "http://dev.jsonbecker.com/css/simple-grid.css" rel = "stylesheet" type = "text/css"> 
  <link href = "http://dev.jsonbecker.com/css/post.css" rel = "stylesheet" type = "text/css">
  
  <link rel="stylesheet" href="http://dev.jsonbecker.com/css/tomorrow-night-bright.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/font-hack/2.020/css/hack.min.css">
  <script src="http://dev.jsonbecker.com/js/highlight.pack.js"></script>
  <script>  
    hljs.initHighlightingOnLoad();
  </script>
	<script>
  	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  	ga('create', 'UA-40920108-1', 'auto');
  	ga('send', 'pageview');
	</script>
<body>
    <div class = "title-bar">
      <h1 class = "title"> json.blog </h1>
      <h3 class = "nav">
          <a href = "http://dev.jsonbecker.com">Home</a> | 
          <a href = "http://dev.jsonbecker.com/archive">Archives</a> |
          <a href = "http://dev.jsonbecker.com/about">About</a>
      </h3>
    </div>
  <div class = 'container'>
  

    <div class = 'row post-title'>
    <div class = 'col-12'>
      <h1>Documentation of Business Rules and Analysis</h1>
    <h6 class = "date">September 13, 2013</h6> 
    <h6 class = "perma"><a href = "http://dev.jsonbecker.com/2013/09/documentation-of-business-rules-and-analysis">&infin;</a></h6>
    </div>
  </div>
  <div class = 'row'>
    <div class = 'col-12'>
      <p>One of the most challenging aspects of being a data analyst is translating programmatic terms like &ldquo;student mobility&rdquo; into precise business rules. Almost any simple statistic involves a series of decisions that are often opaque to the ultimate users of that statistic.</p>

<p>Documentation of business rules is a critical aspect of a data analysts job that, in my experience, is often regrettably overlooked. If you have ever tried to reproduce someone else&rsquo;s analysis, asked different people for the same statistic, or tried to compare data from multiple years, you have probably encountered difficulties getting a consistent answer on standard statistics, e.g. how many students were proficient in math, how many students graduated in four years, what proportion of students were chronically absent? All too often documentation of business rules is poor or non-existent. The result is that two analysts with the same data will produce inconsistent statistics. This is not because of something inherent in the quality of the data or an indictment of the analyst&rsquo;s skills. In most cases, the undocumented business rules are essentially trivial, in that the results of any decision has a small impact on the final result and any of the decisions made by the analysts are equally defensible.</p>

<p>This major problem of lax or non-existent documentation is one of the main reasons I feel that analysts, and in particular analysts working in the public sector, should extensively use tools for code sharing and version control like <a href="http://www.github.com/">Github</a>, use free tools whenever possible, and generally adhere to best practices in reproducible research.</p>

<p>I am trying to put as much of my code on Github as I can these days. Much of what I write is still very disorganized and, frankly, embarrassing. A lot of what is in my Github repositories is old, abandoned code written as I was learning my craft. A lot of it is written to work with very specific, private data. Most of it is poorly documented because I am the only one who has ever had to use it, I don&rsquo;t interact with anyone through practices like code reviews, and frankly I am lazy when pressed with a deadline. But that&rsquo;s not really the point, is it? The worst documented code is code that is hidden away on a personal hard drive, written for an expensive proprietary environment most people and organizations cannot use, or worse, is not code at all but rather a series of destructive data edits and manipulations. <sup class="footnote-ref" id="fnref:fuckexcel"><a rel="footnote" href="#fn:fuckexcel">1</a></sup></p>

<p>One way that I have been trying to improve the quality and utility of the code I write is by contributing to an open source R package, <code>eeptools</code>. This is a package written and maintained by Jared Knowles, an employee of the Wisconsin Department of Public Instruction, whom I met at a <a href="http://www.gse.harvard.edu/sdp/">Strategic Data Project</a> convening. <code>eeptools</code> is consolidating several functions in R for common tasks education data analysts are faced with. Because this package is available on <a href="http://cran.us.r-project.org/">CRAN</a>, the primary repository for R packages, any education analyst can have access to its functions in one line:</p>

<pre><code class="language-r">install.packages('eeptools'); require(eeptools)
</code></pre>

<p>Submitting code to a CRAN package reinforces several habits. First, I get to practice writing R documentation,  explaining how to use a function, and therefore, articulating the assumptions and business rules I am applying. Second, I have to write my code with a wider tolerance for input data. One of the easy pitfalls of a beginning analyst is writing code that is too specific to the dataset in front of you. Most of the errors I have found in analyses during quality control stem from assumptions embedded in code that were perfectly reasonable with a single data set that lead to serious errors when using different data. One way to avoid this issue is through <a href="http://en.wikipedia.org/wiki/Test-driven_development">test-driven development</a>, writing a good testing suite that tests a wide range of unexpected inputs. I am not quite there yet, personally, but thinking about how my code would have to work with arbitrary inputs and ensuring it fails gracefully <sup class="footnote-ref" id="fnref:fallingwithstyle"><a rel="footnote" href="#fn:fallingwithstyle">2</a></sup> is an excellent side benefit of preparing a pull request <sup class="footnote-ref" id="fnref:gitterms"><a rel="footnote" href="#fn:gitterms">3</a></sup> . Third, it is an opportunity to write code for someone other than myself. Because I am often the sole analyst with my skillset working on a project, it is easy to not consider things like style, optimizations, clarity, etc. This can lead to large build-ups of <a href="http://en.wikipedia.org/wiki/Technical_debt">technical debt</a>, complacency toward learning new techniques, and general sloppiness. Submitting a pull request feels like publishing. The world has to read this, so it better be something I am proud of that can stand up to the scrutiny of third-party users.</p>

<p>My first pull request, which was accepted into the package, calculates age in years, months, or days at an arbitrary date based on date of birth. While even a beginning R programmer can develop a similar function, it is the perfect example of an easily compartmentalized component, with a broad set of applications, that can be accessed frequently .</p>

<p>Today I submitted by second pull request that I hope will be accepted. This time I covered a much more complex task&ndash; calculating student mobility. To be honest, I am completely unaware of existing business rules and algorithms used to produce the mobility numbers that are federally reported. I wrote this function from scratch thinking through how I would calculate the number of schools attended by a student in a given year. I am really proud of both the business rules I have developed and the code I wrote to apply those rules. My custom function can accept fairly arbitrary inputs, fails gracefully when it finds data it does not expect, and is pretty fast. The original version of my code took close to 10 minutes to run on ~30,000 rows of data. I have reduced that with a complete rewrite prior to submission to 16 seconds.</p>

<p>While I am not sure if this request will be accepted, I will be thrilled if it is. Mobility is a tremendously important statistic in education research and a standard, reproducible way to calculate it would be a great help to researchers. How great would it be if <code>eeptools</code> becomes one of the first packages education data analysts load and my mobility calculations are used broadly by researchers and analysts? But even if it&rsquo;s not accepted because it falls out of scope, the process of developing the business rules, writing an initial implementation of those rules, and then refining that code to be far simpler, faster, and less error prone was incredibly rewarding.</p>

<p>My next post will probably be a review of that process and some parts of my <code>moves_calc</code> function that I&rsquo;m particularly proud of.</p>
<div class="footnotes">

<hr />

<ol>
<li id="fn:fuckexcel">Using a spreadsheet program, such as Excel, encourages directly manipulating and editing the source data. Each change permanently changes the data. Even if you keep an original version of the data, there is no recording of exactly what was done to change the data to produce your results. Reproducibility is all but impossible of any significant analysis done using spreadsheet software.
 <a class="footnote-return" href="#fnref:fuckexcel"><sup>[return]</sup></a></li>
<li id="fn:fallingwithstyle">Instead of halting the function with hard to understand error when things go wrong, I do my best to &ldquo;correct&rdquo; easily anticipated errors or report back to users in a plain way what needs to be fixed. See also <a href="http://en.wikipedia.org/wiki/Fault-tolerant_system">fault-tolerant system</a>.
 <a class="footnote-return" href="#fnref:fallingwithstyle"><sup>[return]</sup></a></li>
<li id="fn:gitterms">A <a href="https://help.github.com/articles/using-pull-requests">pull request</a> is when you submit your additions, deletions, or any other modifications to be incorporated in someone else&rsquo;s repository.
 <a class="footnote-return" href="#fnref:gitterms"><sup>[return]</sup></a></li>
</ol>
</div>

    </div>
  </div>

  </div>
  <footer class = "license center">
      <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-sa/4.0/80x15.png" /></a><br />This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" style="color: #fff;">Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License</a>.
    </footer>
    </body>
</html>
